---
title: "Term Project"
author: "Nehemya McCarter-Ribakoff"
date: "April 20, 2017"
output:
  pdf_document: default
  highlight: pygments
  html_document: null
  fig_height: 4
  theme: spacelab
---

```{r setup, include=FALSE}
# DO NOT ALTER CODE IN THIS CHUNK
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)

```

* * *

```{r}
park.names = read.table("parks.csv", header = TRUE, sep = ",", quote="\"'", dec=".")
species = read.csv("species.csv", header = TRUE, sep = ",")
```

Let's get a basic familiarity with the data first: a look at category frequency

```{r}
barplot(table(species$Category), main = "Species Category Frequency")
```

Our set consists primarily of vascular plants, with relatively large proportions of birds and instects as well.


We begin with a basic k-means clustering analysis. Lets cluster parks together based on number of fungi species

```{r}
# Obtain all fungi observations
park.vasc.plants = subset(species, Category == "Vascular Plant")
# Remove those not marked as "Present"
park.vasc.plants = subset(park.vasc.plants, Occurrence == "Present")
# Build into frequency table of each park name occurrence.
# This corresponds to a separate species entry for each park
park.vasc.plants = data.frame(table(park.vasc.plants$Park.Name))
row.names(park.vasc.plants) = park.vasc.plants$Var1

# Add latitude
park.vasc.plants.latitude = data.frame(park.vasc.plants, park.names$Latitude)
park.vasc.plants.latitude = subset(park.vasc.plants.latitude, select = -Var1)
set.seed(1)

kmeans.out = kmeans(park.vasc.plants.latitude, 4, nstart = 50)
plot(kmeans.out$centers)
```

Let's try hierarchical clustering

```{r}
hclust.complete = hclust(dist(park.vasc.plants.latitude), method = "complete")
hclust.avg = hclust(dist(park.vasc.plants.latitude$Freq), method = "average")
hclust.single = hclust(dist(park.vasc.plants.latitude$Freq), method = "single")
plot(hclust.complete, main = "Complete Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.avg, main = "Average Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.single, main = "Single Linkage", xlab = "", sub = "", cex = .9)
```


Compare these results to those including only native species
```{r}
native.species = subset(species, Nativeness == "Native")
plot(native.species$Category)
```

Note a marked decrease in the observations of fish and insects. Vascular plants still dominate.

Let's view the distribution without vascular plants

```{r}
native.species.no.vasc = subset(native.species, Category != "Vascular Plant")
plot(native.species.no.vasc$Category)
```

We have a high incidence of native birds, insects, reptiles, and fish.
Biodiversity

We will be using the R package "vegan" (vegetation analysis) for our biodiversity measure

```{r}
install.packages('vegan')
```

```{r}
species.table = table(species$Scientific.Name)
species.count = nrow(species.table)
total.obs = nrow(species)
species.count / total.obs
```

We can consider our base biodiversity index at 0.3859
Let's look at 