---
title: "Term Project"
author: "Nehemya McCarter-Ribakoff"
date: "April 20, 2017"
output:
  pdf_document: default
  highlight: pygments
  html_document: null
  fig_height: 4
  theme: spacelab
---

```{r setup, include=FALSE}
# DO NOT ALTER CODE IN THIS CHUNK
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)

```

* * *

```{r}
park.names = read.table("parks.csv", header = TRUE, sep = ",", quote="\"'", dec=".")
species = read.csv("species.csv", header = TRUE, sep = ",")
```

Let's get a basic familiarity with the data first: a look at category frequency

```{r}
barplot(table(species$Category), main = "Species Category Frequency")
```

Our set consists primarily of vascular plants, with relatively large proportions of birds and instects as well.


We begin with a basic k-means clustering analysis. Lets cluster parks together based on number of fungi species

```{r}
# Obtain all fungi observations
park.fungi = subset(species, Category == "Fungi")
park.birds = subset(species, Category == "Bird")
park.mammals = subset(species, Category == "Mammal")
park.vasc.plants = subset(species, Category == "Vascular Plant")
# Remove those not marked as "Present"
park.vasc.plants = subset(park.vasc.plants, Occurrence == "Present")
# Build into frequency table of each park name occurrence.
# This corresponds to a separate species entry for each park
park.vasc.plants = data.frame(table(park.vasc.plants$Park.Name))

set.seed(1)
# Let's try 3 clusters
kmeans.out = kmeans(park.vasc.plants$Freq, 4, nstart = 50)
plot(kmeans.out$cluster)
```

Let's try hierarchical clustering for another look

```{r}
hclust.complete = hclust(dist(park.vasc.plants$Freq), method = "complete")
hclust.avg = hclust(dist(park.vasc.plants$Freq), method = "average")
hclust.single = hclust(dist(park.vasc.plants$Freq), method = "single")
plot(hclust.complete, main = "Complete Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.avg, main = "Average Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.single, main = "Single Linkage", xlab = "", sub = "", cex = .9)
```

Biodiversity

We will be using the R package "vegan" (vegetation analysis) for our biodiversity measure

```{r}
install.packages('vegan')
```

```{r}
species.table = table(species$Scientific.Name)
species.count = nrow(species.table)
total.obs = nrow(species)
species.count / total.obs
```

We can consider our base biodiversity index at 0.3859
Let's look at 