---
title: "Term Project"
author: "Nehemya McCarter-Ribakoff"
date: "April 20, 2017"
output:
  pdf_document: default
  highlight: pygments
  html_document: null
  fig_height: 4
  theme: spacelab
---

```{r setup, include=FALSE}
# DO NOT ALTER CODE IN THIS CHUNK
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)

```

* * *

```{r}
park.names = read.table("parks.csv", header = TRUE, sep = ",", quote="\"'", dec=".")
species = read.csv("species.csv", header = TRUE, sep = ",")
```

Let's remove dimensions we likely won't get much use out of:

```{r}
species = subset(species, select = -c(Scientific.Name, Common.Names, Species.ID, Record.Status))
```

And create a dataframe with everything we'll need, with features to be added:

```{r}
frequencies.df = data.frame(park.names$Park.Name, park.names$State, park.names$Acres, park.names$Latitude, "Vascular.Plant.Freq", "Bird.Freq", "Insect.Freq", "Fungi.Freq", "Nonvasc.Plant.Freq", "Fish.Freq", "Mammal.Freq", "Intervebrate.Freq", "Reptile.Freq", "Algae.Freq", "Slug/Snail.Freq", "Spider/Scorpion.Freq", "Ambphibian.Freq", "Crustacean.Freq")
colnames(frequencies.df) = c("Park.Name", "State", "Acres", "Latitude", "Vascular.Plant.Freq", "Brid.Freq", "Insect.Freq", "Fungi.Freq", "Nonvasc.Plant.Freq", "Fish.Freq", "Mammal.Freq", "Intervebrate.Freq", "Reptile.Freq", "Algae.Freq", "SlugSnail.Freq", "SpiderScorpion.Freq", "Ambhipian.Freq", "Crustacean.Freq")

frequencies.df[, 5:18] = 0
```

A function to populate our frequency table

```{r}
categoryFreq = function(old.frequencies.df, parkName, parkIndex, category) {
  temp.data = subset(species, species$Park.Name == parkName)
  old.frequencies.df[parkIndex, 5] = sum(temp.data$Category == category)
  new.frequencies.df = old.frequencies.df
  
  return(new.frequencies.df)
}
```

Let's get a basic familiarity with the data first: a look at category frequency

```{r}
barplot(table(species$Category), main = "Species Category Frequency")
```

Our set consists primarily of vascular plants, with relatively large proportions of birds and instects as well.


We begin with a basic k-means clustering analysis. Lets cluster parks together based on number of fungi species

```{r}
# Obtain all vascular plant observations
park.vasc.plants = subset(species, Category == "Vascular Plant")
# Remove those not marked as "Present"
park.vasc.plants = subset(park.vasc.plants, Occurrence == "Present")
# Build into frequency table of each park name occurrence.
# This corresponds to a separate species entry for each park
park.vasc.plants = data.frame(table(park.vasc.plants$Park.Name))
row.names(park.vasc.plants) = park.vasc.plants$Var1

# Add latitude
park.vasc.plants.latitude = data.frame(park.vasc.plants, park.names$Latitude)
park.vasc.plants.latitude = subset(park.vasc.plants.latitude, select = -Var1)
set.seed(1)

kmeans.out = kmeans(park.vasc.plants.latitude, 4, nstart = 50)
plot(kmeans.out$cluster)
```

This example is excessively simple. Let's add a few features.


Let's try hierarchical clustering

```{r}
hclust.complete = hclust(dist(park.vasc.plants.latitude), method = "complete")
hclust.avg = hclust(dist(park.vasc.plants.latitude$Freq), method = "average")
hclust.single = hclust(dist(park.vasc.plants.latitude$Freq), method = "single")
plot(hclust.complete, main = "Complete Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.avg, main = "Average Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.single, main = "Single Linkage", xlab = "", sub = "", cex = .9)
```


Compare these results to those including only native species
```{r}
native.species = subset(species, Nativeness == "Native")
plot(native.species$Category)
```

Note a marked decrease in the observations of fish and insects. Vascular plants still dominate.

Let's view the distribution without vascular plants

```{r}
native.species.no.vasc = subset(native.species, Category != "Vascular Plant")
plot(native.species.no.vasc$Category)
```

We have a high incidence of native birds, insects, reptiles, and fish.
Biodiversity

```{r}
native.birds = subset(native.species, Category == "Bird")
native.birds = subset(native.birds, Occurrence == "Present")
plot(native.birds$Seasonality)
bird.seasonality = table(native.birds$Seasonality)
bird.seasonality = data.frame(bird.seasonality)
```

Clustering for native bird seasonality

```{r}
hclust.complete = hclust(table(native.birds$Seasonality), method = "complete")
hclust.avg = hclust(dist(native.birds$Seasonality), method = "average")
hclust.single = hclust(dist(native.birds$Seasonality), method = "single")
plot(hclust.complete, main = "Complete Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.avg, main = "Average Linkage", xlab = "", sub = "", cex = .9)
plot(hclust.single, main = "Single Linkage", xlab = "", sub = "", cex = .9)
```

Plan

Create new data frame containing park names, the frequency of each category in each park, park latitude, park acres, and park state

